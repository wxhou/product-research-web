# enhance-report-page Tasks

## 1. 组件结构重构

- [ ] 1.1 创建 ReportTableOfContents.tsx 组件基础结构
- [ ] 1.2 创建 ReportProgressBar.tsx 组件基础结构
- [ ] 1.3 创建 ChartModal.tsx 组件基础结构
- [ ] 1.4 创建 ReportEmptyState.tsx 组件基础结构
- [ ] 1.5 重构 ReportViewer.tsx 为容器组件

## 2. 目录导航实现

- [ ] 2.1 实现 Markdown 标题自动提取和 ID 注入
- [ ] 2.2 实现 TOC 组件的 IntersectionObserver 监听
- [ ] 2.3 实现 TOC 高亮状态管理
- [ ] 2.4 实现 TOC 点击滚动跳转功能
- [ ] 2.5 集成 TOC 到 ReportViewer

## 3. 阅读进度条实现

- [ ] 3.1 实现滚动位置计算逻辑
- [ ] 3.2 实现进度条 UI 组件
- [ ] 3.3 实现进度条动画效果
- [ ] 3.4 集成进度条到 ReportViewer

## 4. 面包屑导航实现

- [ ] 4.1 创建面包屑导航组件
- [ ] 4.2 实现章节下拉菜单
- [ ] 4.3 实现下拉菜单滚动跳转功能
- [ ] 4.4 集成面包屑导航到 ReportViewer

## 5. 图表模态框实现

- [ ] 5.1 实现 ChartModal 组件基础结构
- [ ] 5.2 实现 React Portal 渲染
- [ ] 5.3 实现 ESC 键关闭功能
- [ ] 5.4 实现点击遮罩层关闭功能
- [ ] 5.5 集成模态框到 ReportViewer

## 6. 图表下载功能

- [ ] 6.1 实现 SVG 转 PNG 转换函数
- [ ] 6.2 实现 PNG 下载功能
- [ ] 6.3 实现 SVG 下载 fallback
- [ ] 6.4 添加下载按钮到模态框

## 7. 图表错误处理

- [ ] 7.1 修改 mermaid 渲染逻辑添加错误捕获
- [ ] 7.2 实现错误状态 UI 组件
- [ ] 7.3 实现重试渲染功能
- [ ] 7.4 实现手动编辑功能

## 8. 打印样式优化

- [ ] 8.1 添加 @media print 隐藏规则
- [ ] 8.2 实现图表打印样式
- [ ] 8.3 实现表格打印样式
- [ ] 8.4 实现链接 URL 显示
- [ ] 8.5 添加页面边距设置

## 9. PDF 导出功能

- [ ] 9.1 实现 Export PDF 按钮
- [ ] 9.2 配置打印对话框
- [ ] 9.3 设置 PDF 文件名
- [ ] 9.4 添加 PDF 元数据

## 10. 测试与修复

- [ ] 10.1 组件单元测试
- [ ] 10.2 集成测试
- [ ] 10.3 响应式测试
- [ ] 10.4 浏览器兼容性测试
- [ ] 10.5 修复发现的问题

## 11. 文档与清理

- [ ] 11.1 更新组件使用文档
- [ ] 11.2 清理废弃代码
- [ ] 11.3 运行完整测试套件

## 12. 代码块优化

- [ ] 12.1 实现代码块语法高亮主题切换功能
- [ ] 12.2 实现代码块一键复制功能
- [ ] 12.3 添加复制成功反馈提示

## 13. 关键词标签显示

- [ ] 13.1 提取报告关键词数据
- [ ] 13.2 实现关键词标签 UI 组件
- [ ] 13.3 集成关键词到报告头部
